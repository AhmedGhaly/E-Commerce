@model Review

<div class="container">
    <div class="user-review mt-4">
        <form>
            <div class="d-flex justify-content-between">
                <h3>User name</h3>
                <div class="rating">
                    <p class="product-rating mb-3">
                        <input id="stars-input" style="display:none;" value="0" asp-for="Rate" />
                        <span class="stars-num mr-1">0</span><span class="stars">
                            <i class="far fa-star" data-rating="1"></i>
                            <i class="far fa-star" data-rating="2"></i>
                            <i class="far fa-star" data-rating="3"></i>
                            <i class="far fa-star" data-rating="4"></i>
                            <i class="far fa-star" data-rating="5"></i>
                        </span>
                    </p>
                </div>
            </div>
            <textarea name="Text"
                asp-for="Text"
                        cols="40"
                        rows="4"
                        class="form-control mb-3"
                        placeholder="Write your review...">

            </textarea>
            <input type="submit" value="Create" class="btn btn-primary" />
        </form>
    </div>
</div>

<script>

    function updateStarRating() {
        const productRatingElements = document.querySelectorAll(".stars-input");

        productRatingElements.forEach(ratingElement => {
            const ratingText = ratingElement.textContent.trim().split(" ")[0];
            const rating = parseFloat(ratingText);
            ratingElement.value.value = rating; // Update data-rating-num
        });
    }

    document.addEventListener("DOMContentLoaded", function () {
        const starsContainer = document.querySelector(".rating .stars");
        const starsNum = document.querySelector(".stars-num");
        const starIcons = document.querySelectorAll(".rating .stars i[data-rating]");
        const starsInput = document.getElementById("stars-input");

        let currentRating = 0;
        let hoveringRating = 0;

        starIcons.forEach(star => {
            star.addEventListener("mouseover", event => {
                const rating = event.target.getAttribute("data-rating");
                hoveringRating = rating;
                starsInput.value = rating;
                starsNum.textContent = hoveringRating; // Update stars-num on hover
                updateStars();
            });

            star.addEventListener("mouseout", () => {
                hoveringRating = currentRating;
                starsInput.value = 0;
                starsNum.textContent = hoveringRating; // Update stars-num on mouseout
                updateStars();
            });

            star.addEventListener("click", event => {
                const rating = event.target.getAttribute("data-rating");
                currentRating = rating;
                starsInput.value = rating;
                starsNum.textContent = currentRating; // Update stars-num on click
                updateStars();
            });
        });

        function updateStars() {
            starIcons.forEach(star => {
                const rating = star.getAttribute("data-rating");
                if (rating <= hoveringRating) {
                    star.classList.add("fas");
                } else {
                    star.classList.remove("fas");
                }
            });

            updateStarRating(); // Update data-rating-num
        }
    });

</script>